# Lovcode - AI Coding Tools çš„æ¡Œé¢ä¼´ä¾£

Tauri 2 + React 19 + TypeScript + Rust

> ä»£ç æ˜¯æœºå™¨ç›¸ï¼Œæ–‡æ¡£æ˜¯è¯­ä¹‰ç›¸ï¼Œä¸¤ç›¸å¿…é¡»åŒæ„ã€‚
> ä»»ä¸€ç›¸å˜åŒ–ï¼Œå¿…é¡»åœ¨å¦ä¸€ç›¸æ˜¾ç°ï¼Œå¦åˆ™è§†ä¸ºæœªå®Œæˆã€‚

---

## æ¶æ„æ€»è§ˆ

```
lovcode/
â”œâ”€â”€ src/                    # React å‰ç«¯ (Vite, TypeScript)
â”‚   â”œâ”€â”€ components/         # UI ç»„ä»¶åº“ (shadcn/ui + ä¸šåŠ¡ç»„ä»¶)
â”‚   â”œâ”€â”€ views/              # é¡µé¢è§†å›¾ (14 ä¸ªåŠŸèƒ½æ¨¡å—)
â”‚   â”œâ”€â”€ store/              # çŠ¶æ€ç®¡ç† (Jotai atoms)
â”‚   â”œâ”€â”€ hooks/              # è‡ªå®šä¹‰ hooks
â”‚   â”œâ”€â”€ types/              # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ context/            # React Context
â”‚   â”œâ”€â”€ lib/                # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ constants/          # å¸¸é‡å®šä¹‰
â”‚
â”œâ”€â”€ src-tauri/              # Rust åç«¯ (Tauri 2) âœ… å·²æ¨¡å—åŒ–
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ lib.rs          # åº”ç”¨å…¥å£ (804è¡Œ) âœ…
â”‚       â”œâ”€â”€ main.rs         # ç¨‹åºå…¥å£
â”‚       â”œâ”€â”€ errors.rs       # ç»Ÿä¸€é”™è¯¯ç±»å‹
â”‚       â”œâ”€â”€ security.rs     # å®‰å…¨éªŒè¯
â”‚       â”œâ”€â”€ types.rs        # å…±äº«ç±»å‹
â”‚       â”œâ”€â”€ pty_manager.rs  # ç»ˆç«¯ä¼šè¯ç®¡ç†
â”‚       â”œâ”€â”€ workspace_store.rs  # å·¥ä½œåŒºæŒä¹…åŒ–
â”‚       â”œâ”€â”€ diagnostics.rs  # é¡¹ç›®è¯Šæ–­åˆ†æ
â”‚       â”œâ”€â”€ hook_watcher.rs # æ–‡ä»¶ç›‘å¬
â”‚       â”œâ”€â”€ commands/       # âœ… å‘½ä»¤æ¨¡å— (11ä¸ª)
â”‚       â”‚   â”œâ”€â”€ agents.rs       # Agent/Skill ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ context.rs      # ä¸Šä¸‹æ–‡æ–‡ä»¶
â”‚       â”‚   â”œâ”€â”€ files.rs        # æ–‡ä»¶æ“ä½œ
â”‚       â”‚   â”œâ”€â”€ git.rs          # Git æ“ä½œ
â”‚       â”‚   â”œâ”€â”€ knowledge.rs    # çŸ¥è¯†åº“
â”‚       â”‚   â”œâ”€â”€ local_commands.rs # æœ¬åœ°å‘½ä»¤
â”‚       â”‚   â”œâ”€â”€ marketplace.rs  # æ¨¡æ¿å¸‚åœº
â”‚       â”‚   â”œâ”€â”€ projects.rs     # é¡¹ç›®ä¼šè¯
â”‚       â”‚   â”œâ”€â”€ report.rs       # æŠ¥å‘Šç»Ÿè®¡
â”‚       â”‚   â”œâ”€â”€ settings.rs     # è®¾ç½®ç®¡ç†
â”‚       â”‚   â””â”€â”€ version.rs      # ç‰ˆæœ¬ç®¡ç†
â”‚       â””â”€â”€ services/       # âœ… æœåŠ¡æ¨¡å—
â”‚           â””â”€â”€ search.rs       # å…¨æ–‡æœç´¢ (Tantivy + Jieba)
â”‚
â”œâ”€â”€ third-parties/          # Git å­æ¨¡å— (æ–‡æ¡£/æ¨¡æ¿)
â”œâ”€â”€ marketplace/            # ç¤¾åŒºæ¨¡æ¿å¸‚åœº
â””â”€â”€ docs/                   # é¡¹ç›®æ–‡æ¡£
```

---

## æ ¸å¿ƒå‘½ä»¤

```bash
pnpm tauri dev      # å¼€å‘æ¨¡å¼ (å‰åç«¯çƒ­é‡è½½)
pnpm typecheck      # TypeScript ç±»å‹æ£€æŸ¥
pnpm clippy         # Rust ä»£ç æ£€æŸ¥
pnpm audit          # ä¾èµ–å®‰å…¨å®¡è®¡
pnpm tauri build    # æ„å»ºå‘å¸ƒåŒ…
```

**ç¦æ­¢**: æœ¬åœ°è¿è¡Œ `pnpm tauri dev` æ—¶ä¸è¦æ‰§è¡Œ `pnpm build`

---

## è®¾è®¡ç³»ç»Ÿ: Lovstudio æš–å­¦æœ¯é£æ ¼

| å…ƒç´  | è§„èŒƒ |
|------|------|
| ä¸»è‰² | `#CC785C` é™¶åœŸè‰² (Primary) |
| èƒŒæ™¯ | `#F9F9F7` æš–ç±³è‰² |
| å‰æ™¯ | `#181818` ç‚­ç°è‰² |
| è¾¹æ¡† | `#E8E6DC` |
| æ ‡é¢˜ | `font-serif` |
| æ­£æ–‡ | `font-sans` |
| åœ†è§’ | `rounded-lg` / `rounded-xl` / `rounded-2xl` |

**é“å¾‹**:
- ç¦æ­¢ç¡¬ç¼–ç é¢œè‰²ï¼Œå¿…é¡»ç”¨ semantic ç±»å
- ä¼˜å…ˆä½¿ç”¨ shadcn/ui ç»„ä»¶
- ä¸»æŒ‰é’®: `bg-primary text-primary-foreground hover:bg-primary/90`
- å¡ç‰‡: `bg-card border border-border rounded-xl`

---

## ä»£ç è§„èŒƒ

### Linus å“å‘³å‡†åˆ™

```
å¥½ä»£ç ä¸éœ€è¦ä¾‹å¤–ã€‚ä¸‰ä¸ªä»¥ä¸Šåˆ†æ”¯ç«‹å³åœæ­¢é‡æ„ã€‚
èƒ½æ¶ˆå¤±çš„åˆ†æ”¯æ°¸è¿œæ¯”èƒ½å†™å¯¹çš„åˆ†æ”¯æ›´ä¼˜é›…ã€‚
```

| è§„åˆ™ | æ ‡å‡† | çŠ¶æ€ |
|------|------|------|
| æ–‡ä»¶è¡Œæ•° | â‰¤ 800 è¡Œ | âœ… lib.rs 804è¡Œ |
| å‡½æ•°è¡Œæ•° | â‰¤ 20 è¡Œ | âœ… |
| ç¼©è¿›å±‚çº§ | â‰¤ 3 å±‚ | âœ… |
| æ–‡ä»¶å¤¹æ–‡ä»¶æ•° | â‰¤ 8 ä¸ª/å±‚ | âš ï¸ commands/ 11ä¸ª |

### ä»£ç åå‘³é“æ£€æµ‹

- **åƒµåŒ–**: å¾®å°æ”¹åŠ¨å¼•å‘è¿é”ä¿®æ”¹
- **å†—ä½™**: ç›¸åŒé€»è¾‘é‡å¤å‡ºç°
- **å¾ªç¯ä¾èµ–**: æ¨¡å—äº’ç›¸çº ç¼ 
- **è„†å¼±æ€§**: ä¸€å¤„ä¿®æ”¹å¯¼è‡´æ— å…³éƒ¨åˆ†æŸå
- **æ™¦æ¶©æ€§**: ä»£ç æ„å›¾ä¸æ˜

å‘ç°åå‘³é“ â†’ ç«‹å³è¯¢é—®æ˜¯å¦ä¼˜åŒ– â†’ ç»™å‡ºæ”¹è¿›å»ºè®®

### Rust è§„èŒƒ

```toml
# å·²é…ç½® Clippy ä¸¥æ ¼æ¨¡å¼
[lints.clippy]
unwrap_used = "warn"    # ç¦æ­¢ .unwrap()
expect_used = "warn"    # è­¦å‘Š .expect()
panic = "warn"          # è­¦å‘Šæ˜¾å¼ panic!
```

- ä½¿ç”¨ `thiserror` å®šä¹‰é”™è¯¯ç±»å‹
- ä½¿ç”¨ `anyhow` å¤„ç†é”™è¯¯ä¼ æ’­
- æ–‡ä»¶å†™å…¥å¿…é¡»åŸå­åŒ– (ä¸´æ—¶æ–‡ä»¶ + é‡å‘½å)

### TypeScript è§„èŒƒ

- ä¸¥æ ¼æ¨¡å¼ (`strict: true`)
- ç¦æ­¢ `any`ï¼Œé™åˆ¶ `unknown` ä½¿ç”¨
- å‰åç«¯ç±»å‹å¿…é¡»åŒæ­¥
- é”™è¯¯å¿…é¡»æœ‰ç”¨æˆ·åé¦ˆï¼Œç¦æ­¢ `.catch(() => {})`

---

## GEB åˆ†å½¢æ–‡æ¡£åè®®

### ä¸‰å±‚ç»“æ„

| å±‚çº§ | ä½ç½® | èŒè´£ | è§¦å‘æ›´æ–° |
|------|------|------|----------|
| L1 | `/CLAUDE.md` | é¡¹ç›®å®ªæ³•Â·å…¨å±€åœ°å›¾ | æ¶æ„å˜æ›´/é¡¶çº§æ¨¡å—å¢åˆ  |
| L2 | `/{module}/CLAUDE.md` | å±€éƒ¨åœ°å›¾Â·æˆå‘˜æ¸…å• | æ–‡ä»¶å¢åˆ /æ¥å£å˜æ›´ |
| L3 | æ–‡ä»¶å¤´éƒ¨æ³¨é‡Š | INPUT/OUTPUT/POS å¥‘çº¦ | ä¾èµ–/å¯¼å‡º/èŒè´£å˜æ›´ |

### L3 å¤´éƒ¨æ¨¡æ¿

```typescript
/**
 * [INPUT]: ä¾èµ– {æ¨¡å—/æ–‡ä»¶} çš„ {å…·ä½“èƒ½åŠ›}
 * [OUTPUT]: å¯¹å¤–æä¾› {å¯¼å‡ºçš„å‡½æ•°/ç»„ä»¶/ç±»å‹}
 * [POS]: {æ‰€å±æ¨¡å—} çš„ {è§’è‰²å®šä½}
 * [PROTOCOL]: å˜æ›´æ—¶æ›´æ–°æ­¤å¤´éƒ¨ï¼Œç„¶åæ£€æŸ¥ CLAUDE.md
 */
```

### å¼ºåˆ¶å›ç¯

```
ä»£ç ä¿®æ”¹ â†’ L3 æ£€æŸ¥ â†’ L2 æ£€æŸ¥ â†’ L1 æ£€æŸ¥ â†’ ä»»åŠ¡å®Œæˆ
```

**æ­»ç½ª**:
- æ”¹ä»£ç ä¸æ£€æŸ¥æ–‡æ¡£ â†’ å›æ»š
- å‘ç° L3 ç¼ºå¤±å´ç»§ç»­ â†’ åœæ­¢å¹¶è¡¥å……
- åˆ æ–‡ä»¶ä¸æ›´æ–° L2 â†’ ç³»ç»Ÿä¸ä¸€è‡´
- æ–°æ¨¡å—ä¸åˆ›å»º L2 â†’ æ–‡æ¡£é»‘æ´

---

## å·²çŸ¥æŠ€æœ¯å€ºåŠ¡

### âœ… å·²ä¿®å¤ (2025-01-03)

| é—®é¢˜ | ä¿®å¤æ–¹æ¡ˆ | çŠ¶æ€ |
|------|----------|------|
| lib.rs 6384è¡Œ | æ¨¡å—åŒ–æ‹†åˆ†ä¸º commands/ + services/ | âœ… 804è¡Œ |
| è·¯å¾„éå†æ”»å‡» | security.rs + validate_decoded_path() | âœ… |
| å‘½ä»¤æ³¨å…¥é£é™© | security.rs + validate_version() | âœ… |

### ğŸŸ¡ å¾…æ”¹è¿›

| é—®é¢˜ | ä½ç½® | ä¼˜å…ˆçº§ |
|------|------|--------|
| æ–‡ä»¶å†™å…¥éåŸå­åŒ– | workspace_store.rs | P1 |
| UTF-8 å­—ç¬¦ä¸²åˆ‡å‰²é£é™© | diagnostics.rs | P1 |
| .unwrap() æ®‹ç•™ | å¤šå¤„ | P2 |
| å‰ç«¯ä¸¤å¥—å¯¼èˆªç³»ç»Ÿ | src/components/ | P2 |
| æµ‹è¯•è¦†ç›–ç‡ 0% | å…¨å±€ | P2 |

è¯¦è§: `ENGINEERING_ROADMAP.md`

---

## å‰åç«¯é€šä¿¡

```typescript
// å‰ç«¯è°ƒç”¨
import { invoke } from '@tauri-apps/api/core';
const projects = await invoke<Project[]>('list_projects');
```

```rust
// åç«¯å®šä¹‰ (åœ¨ commands/*.rs ä¸­)
#[tauri::command]
pub fn list_projects() -> Result<Vec<Project>, String> { ... }

// åœ¨ commands/mod.rs ä¸­å¯¼å‡º
pub use projects::list_projects;

// åœ¨ lib.rs ä¸­æ³¨å†Œ
tauri::generate_handler![
    commands::list_projects,
    // ...
]
```

---

## ç›®å½•èŒè´£é€ŸæŸ¥

| ç›®å½• | èŒè´£ | å…³é”®æ–‡ä»¶ |
|------|------|----------|
| `src/views/` | 14 ä¸ªåŠŸèƒ½é¡µé¢ | Chat, Workspace, Commands... |
| `src/components/ui/` | shadcn/ui å°è£… | button, dialog, tabs... |
| `src/components/shared/` | ä¸šåŠ¡é€šç”¨ç»„ä»¶ | NavSidebar, SidebarLayout... |
| `src/store/atoms/` | Jotai çŠ¶æ€ | app, chat, workspace... |
| `src-tauri/src/commands/` | Tauri å‘½ä»¤ | 11 ä¸ªåŠŸèƒ½æ¨¡å— |
| `src-tauri/src/services/` | åå°æœåŠ¡ | search.rs (å…¨æ–‡æœç´¢) |

---

## L2 æ–‡æ¡£ç´¢å¼•

| æ¨¡å— | L2 æ–‡æ¡£ | çŠ¶æ€ |
|------|---------|------|
| src-tauri/ | `src-tauri/CLAUDE.md` | âœ… å·²æ›´æ–° |
| src/ | `src/CLAUDE.md` | âš ï¸ å¾…åˆ›å»º |

---

*Keep the map aligned with the terrain, or the terrain will be lost.*

[PROTOCOL]: æ¶æ„å˜æ›´æ—¶å¿…é¡»åŒæ­¥æ›´æ–°æ­¤æ–‡æ¡£
